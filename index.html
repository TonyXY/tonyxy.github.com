<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <div class="ui-btn-wrap">
        <button id="fetchPhoto" class="ui-btn-lg ui-btn-primary">
        获取照片
    </button>
    </div>
    <!--<button id="fetchPhoto" class="ui-btn-primary ui-btn-lg">获取照片</button>-->

    <div class="ui-flex  ui-flex-align-center ui-flex-ver ui-flex-pack-center ui-flex-align-start" style="width:100%;height:250px">
        <img id="image" src="" width="180" height="180">
    </div>
    <script src="zepto.min.js"></script>
    <script src="touch.min.js"></script>
    <script src="aladdin.core.min.js"></script>
    <script src="aladdin.camera.web.min.js"></script>
    <script>


    function getSelected$(name){
        return $('input[name="'+name+'"]:checked');
    }

    function  createOptions(){

        return {
            // 默认拍照(1: 拍照，2: 相册)
            source: 1,
            // 默认返回照片 uri
            returnType: 'uri', //uri,base64
            // 照片类型(默认为 jpg )
            type: 'jpg',
            // 选取照片后编辑
            edit: false,
            // 照片宽度
            // width: 100,
            // 照片高度
            // height: 80,
            // 照片质量
            quality: 50
        }
    }

    function showPhoto(url,width,height) {
        $('#image').attr({
            src:url,
            width:width||180,
            height:height||180
        });
    }

    $('#fetchPhoto').on('tap',function(){
        var options=createOptions();
        aladdin.camera.getPhotos(options,function(error, photos){
            if (error) {
                alert('调用失败');
            } else {
                var data = photos[0];
                var imageSrc='';
                if(options.returnType=='base64'){
                    imageSrc=(options.type=='jpg'?'data:image/jpeg;base64,'+data:'data:image/png;base64,'+data);
                }else{
                    if(/^data:image.+?base64,/.test(data)){
                        imageSrc=data;
                    }else{
                        imageSrc='file://'+data;
                    }
                }
                /*var photoInfo=options.returnType=='uri'?
                    'file://'+data:('data:image/'+(options.type=='jpg'?'jpeg;base64,':'png;base64,'+data));*/
               /* alert({
                    message:imageSrc
                });*/
                showPhoto(imageSrc,options.width,options.height);
            }
        });
    });

    </script>
</body>
</html>
